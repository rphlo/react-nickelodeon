{"version":3,"sources":["utils/index.js","components/searchResultItem.js","components/queueItem.js","App.js","serviceWorker.js","index.js"],"names":["prependZero","x","slice","printTime","t","Math","round","h","floor","m","s","join","SearchResultItem","this","props","audio","queue","username","isSuperuser","queueIndex","findIndex","el","id","className","title","filename","onClick","onQueueAudio","src","alt","class","toString","onRandomAudioLoaded","split","pop","owner","editAudioFilename","deleteAudio","React","PureComponent","QueueItem","pkg","require","options","apiRoot","localStorage","devserver","api_homepage","authToken","getItem","is_superuser","App","NETWORK_STATE","NETWORK_EMPTY","NETWORK_IDLE","NETWORK_LOADING","NETWORK_NO_SOURCE","READY_SUCCESS_STATE","state","params","currentAudio","xhrRand","attemptingLogin","currentTime","pause","playId","fetchingNext","firstPlay","playing","searchResults","searchTimeout","xhrSearch","viewQueue","youtubeDL","unBindEvents","bindEvents","onLogin","e","preventDefault","usernameInput","value","password","passwordInput","$","ajax","url","data","dataType","method","done","onLoginSuccess","fail","onLoginFail","setState","response","token","user","setItem","console","log","playNext","swal","fetchRandomAudio","jqXhr","Date","headers","Authorization","r","onAjaxFail","push","newXhrRand","filter","xhr","readyState","newQueue","onfetchingError","clearAuthToken","onLogout","onCurrentAudioPlay","onYoutubeDlPrompt","a","async","content","videoId","ytVideoIdRe","pos","re","map","test","match","v","type","onStartYouTubeDL","task_id","onYoutubeFail","taskId","snackbarMessage","list","fetchStatus","tt","pk","variant","error","setTimeout","status","audioInfo","navigator","mediaSession","metadata","MediaMetadata","artwork","download_url","sizes","setActionHandler","play","onTogglePause","length","nextAudio","shift","getAudioTitle","getAudioSrc","onSearchPrompt","togglePause","setAudioLength","duration","canPlay","loadAndPlayAudio","loading","loadProgress","networkState","onAudioLoadError","audioEnd","onAudioSeeked","onPauseAudio","onAudioPlay","name","target","eventsNames","waiting","canplay","ended","seeked","timeupdate","audioTimeUpdate","stalled","abort","onAudioAbort","bind","once","_events","addEventListener","removeEventListener","_pauseAudio","onTogglePlay","remember","saveLastPlayStatus","onAudioProgress","getBaseAudioInfo","getProgressText","getProgressPercentage","ignore","currentPlayId","playingAudio","loadAudio","musicSrc","load","searchInputKeyPress","which","query","clearTimeout","searchSongs","blur","onSubmitSearchForm","find","trigger","songs","song","element","attributes","defaultValue","newPath","onAudioDownload","downloadNode","setAttribute","click","onMP3Upload","newWindow","window","open","focus","onClickProgressBar","perc","pageX","progressBar","width","displayQueue","undefined","ref","node","style","onSubmit","placeholder","href","contact_email","onKeyPress","idx","key","version","preload","MyApp","useState","setPlaying","useNoSleep","enqueueSnackbar","useSnackbar","msg","opts","paused","Boolean","location","hostname","Sentry","dsn","integrations","Integrations","BrowserTracing","tracesSampleRate","ReactDOM","render","maxSnack","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.3cbd4da7.chunk.js","sourcesContent":["//秒转换成 时间格式\nexport function formatTime(second) {\n    let i = 0;\n    let h = 0;\n    let s = parseInt(second);\n    if (s > 60) {\n      i = parseInt(s / 60);\n      s = parseInt(s % 60);\n      if (i > 60) {\n        h = parseInt(i / 60);\n        i = parseInt(i % 60);\n      }\n    }\n    // 补零\n    const zero = v => (v >> 0 < 10 ? `0${v}` : v);\n    if (h > 0) return [zero(h), zero(i), zero(s)].join(\":\");\n    else return [zero(i), zero(s)].join(\":\");\n  }\n  \n  export function createRandomNum(minNum, maxNum) {\n    return parseInt(Math.random() * (maxNum - minNum + 1) + minNum, 10);\n  }\n  \n  export function distinct(array) {\n    return array\n      .map(item => JSON.stringify(item))\n      .filter((item, idx, arry) => idx === arry.indexOf(item))\n      .map(item => JSON.parse(item));\n  }\n  \n  export const arrayEqual = arr1 => arr2 =>\n    JSON.stringify(arr1) === JSON.stringify(arr2);\n  \n  const s4 = () => {\n    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n  };\n  // Generate a pseudo-GUID by concatenating random hexadecimal.\n  export const uuId = () => {\n    return `${s4() + s4()}-${s4()}-${s4()}-${s4()}-${s4()}${s4()}${s4()}`;\n  };\n  \n  export const isSafari = () => {\n    return (\n      /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent)\n    );\n  };\n\n  export const prependZero = function(x){\n      return ('0' + x).slice(-2);\n  };\n  \n  export const printTime = function(t) {\n    t = Math.round(t);\n    var h = Math.floor(t / 3600),\n        m = Math.floor((t % 3600) / 60),\n        s = t % 60;\n    return [prependZero(h), prependZero(m), prependZero(s)].join(':');\n  };","\nimport React from \"react\";\n\nexport default class SearchResultItem extends React.PureComponent {\n  render() {\n    const { audio, queue, username, isSuperuser } = this.props;\n    const queueIndex = queue.findIndex(el => el.id === audio.id);\n\n    return (\n    <div className=\"searchResultItem\" >\n      <span\n        className=\"link\"\n        title={audio.filename}\n        onClick={()=>this.props.onQueueAudio(audio)} >\n        <img\n          className=\"cover\"\n          src=\"/vinyl.jpg\"\n          alt=\"cover\" />\n        { (queueIndex !== -1) && \n          (<div class=\"queueNumber\">{(queueIndex+1).toString()}</div>)}\n      </span>\n      <span className=\"link\" title={audio.filename} onClick={()=>this.props.onRandomAudioLoaded(audio)}>{ audio.filename.split('/').pop() }</span>\n      { (username === audio.owner || isSuperuser) && <span className=\"searchResultActions\">\n        <span\n          className=\"link\"\n          onClick={()=>this.props.editAudioFilename(audio)} >\n          <i className=\"fas fa-edit\"></i>\n        </span>\n        <span\n          className=\"link\"\n          onClick={()=>this.props.deleteAudio(audio)} >\n          <i className=\"fas fa-trash\"></i>\n        </span>\n      </span>}\n    </div>);\n  } \n}","\nimport React from \"react\";\n\nexport default class QueueItem extends React.PureComponent {\n  render() {\n    const { audio, username, queueIndex, isSuperuser } = this.props;\n\n    return (\n    <div className=\"queueItem\" >\n      <span\n        title={audio.filename}\n      >\n        <img\n          className=\"cover\"\n          src=\"/vinyl.jpg\"\n          alt=\"cover\" />\n        { (queueIndex !== -1) && \n          (<div class=\"queueNumber\">{(queueIndex+1).toString()}</div>)}\n      </span>\n      <span className=\"link\" title={audio.filename} onClick={()=>this.props.onRandomAudioLoaded(audio)}>{ audio.filename.split('/').pop() }</span>\n      { (username === audio.owner || isSuperuser) && <span className=\"searchResultActions\">\n        <span\n          className=\"link\"\n          onClick={()=>this.props.editAudioFilename(audio)} >\n          <i className=\"fas fa-edit\"></i>\n        </span>\n        <span\n          className=\"link\"\n          onClick={()=>this.props.deleteAudio(audio)} >\n          <i className=\"fas fa-trash\"></i>\n        </span>\n      </span>}\n    </div>);\n  } \n}","import React from \"react\";\nimport swal from \"sweetalert\";\nimport $ from \"jquery\";\nimport useNoSleep from \"use-no-sleep\";\nimport { printTime } from \"./utils\";\nimport SearchResultItem from \"./components/searchResultItem\";\nimport QueueItem from \"./components/queueItem\";\nimport { useSnackbar } from 'notistack';\n\nconst pkg = require('../package.json');\n\nconst options = {\n  //audio lists model\n  apiRoot: localStorage.devserver || pkg.api_homepage,\n  authToken: localStorage.getItem('auth_token'),\n  username: localStorage.getItem('username'),\n  is_superuser: localStorage.getItem('is_superuser'),\n};\n\nclass App extends React.PureComponent {\n  NETWORK_STATE = {\n    NETWORK_EMPTY: 0,\n    NETWORK_IDLE: 1,\n    NETWORK_LOADING: 2,\n    NETWORK_NO_SOURCE: 3\n  };\n  READY_SUCCESS_STATE = 4;\n  state = {\n    params: options,\n    currentAudio: {},\n    queue: [],\n    xhrRand: [],\n    attemptingLogin: false,\n    currentTime: 0,\n    pause: true,\n    playId:'',\n    fetchingNext: false,\n    firstPlay: true,\n    playing: false,\n    searchResults: [],\n    searchTimeout: null,\n    xhrSearch: null,\n    viewQueue: false,\n    youtubeDL: {},\n  };\n\n  constructor() {\n    super();\n    console.log(this.state.params.authToken)\n  }\n\n  componentWillUnmount() {\n    this.unBindEvents(this.audio, undefined, false);\n  }\n  \n  componentDidMount() {\n    this.bindEvents(this.audio);\n    if(this.state.params.authToken) {\n      this.playNext();\n    }\n  }\n  unBindEvents = (...options) => {\n    this.bindEvents(...options);\n  };\n\n  onLogin = (e) => {\n    e.preventDefault();\n    const username = this.usernameInput.value,\n          password = this.passwordInput.value;\n    $.ajax({\n      url: this.state.params.apiRoot + '/login/',\n      data: {\n        username: username,\n        password: password\n      },\n      dataType: 'json',\n      method: 'POST'\n    })\n    .done(this.onLoginSuccess)\n    .fail(this.onLoginFail);\n    this.setState({attemptingLogin: true})\n  };\n\n  onLoginSuccess = (response) => {\n    const data = {\n      ...this.state.params,\n      authToken: response.token,\n      username: response.user.username,\n      isSuperuser: response.is_superuser\n    }\n    this.setState({\n      params: data,\n      attemptingLogin: false\n    });\n    localStorage.setItem('auth_token', response.token);\n    localStorage.setItem('username', response.user.username);\n    localStorage.setItem('is_superuser', response.is_superuser);\n    console.log('Login successful');\n    this.playNext();\n  }\n  onLoginFail = () => {\n    this.setState({attemptingLogin: false})\n    swal('Error', 'Username/Password do not match.', 'error');\n  }\n  fetchRandomAudio = () => {\n    const jqXhr = $.ajax({\n        url: this.state.params.apiRoot + '/songs/random?t='+(+new Date()),\n        method: 'GET',\n        dataType: 'json',\n        headers: {\n            Authorization: 'Token ' + this.state.params.authToken\n        }\n    })\n    .done((r)=>this.onRandomAudioLoaded(r))\n    .fail(this.onAjaxFail);\n\n    const xhrRand = this.state.xhrRand;\n    xhrRand.push(jqXhr);\n    const newXhrRand = xhrRand.filter(xhr => xhr.readyState !== 4);\n\n    this.setState({\n      xhrRand: newXhrRand,\n      fetchingNext: true,\n    });\n  };\n  onQueueAudio = (audio) => {\n    const newQueue = this.state.queue.filter(()=>true);\n    newQueue.push(audio);\n    this.setState({queue: newQueue});\n  };\n  onfetchingError = (e) => {\n    this.setState({\n      fetchingNext: false\n    });\n    this.onAjaxFail(e);\n  };\n  clearAuthToken = () => {\n    const data = {\n      ...this.state.params,\n      authToken: null\n    };\n    localStorage.setItem('auth_token', '');\n    this.setState({\n      params: data\n    });\n  }\n  onLogout = (e) => {\n    e.preventDefault();\n    if (!this.state.pause)this.onCurrentAudioPlay('-');\n    this.setState({\n      params: options,\n      currentAudio: {},\n      playId:'',\n      xhrRand: [],\n      attemptingLogin: false,\n      currentTime: 0,\n      pause: true,\n      fetchingNext: false,\n      firstPlay: true,\n      playing: false,\n    })\n    this.clearAuthToken();\n    $.ajax({\n      url: this.state.params.apiRoot + '/logout/',\n      method: 'POST',\n      headers: {\n          Authorization: 'Token ' + this.state.params.authToken\n      }\n    })\n    .done(e => {console.log('Logged out, token removed')});\n  }\n  onYoutubeDlPrompt = async () => {\n    const url = await swal(\"Enter a Youtube URL:\", {\n      content: \"input\",\n    })\n    let videoId = null;\n    const ytVideoIdRe = [\n      {pos: 1, re: /^([a-zA-Z0-9_-]{11})$/},\n      {pos: 4, re: /^(https?:\\/\\/)?(www\\.|m\\.)?youtube\\.com\\/watch\\?(.*&)?v=([a-zA-Z0-9_-]{11})(&.*)?#?$/},\n      {pos: 2, re: /^(https?:\\/\\/)?youtu\\.be\\/([a-zA-Z0-9_-]{11})(\\?.*)?#?$/}\n    ];\n    if (!url) {\n      return;\n    }\n    videoId = ytVideoIdRe.map(function(re) {\n      if (re.re.test(url)) {\n        return url.match(re.re)[re.pos];\n      }\n      return null;\n    }).filter(el => !!el)[0];\n    if (videoId) {\n      console.log('Sending intent to download video ' + videoId);\n      $.ajax(\n        {\n          url: this.state.params.apiRoot + '/youtube-dl/',\n          data: {\n            v: videoId\n          },\n          type: 'POST',\n          headers: {\n            Authorization: 'Token ' + this.state.params.authToken\n          }\n        }\n      )\n      .done(response => this.onStartYouTubeDL(videoId, response.task_id))\n      .fail(e => this.onYoutubeFail(e, videoId));\n    } else {\n      swal('Error', 'Invalid Youtube URL', 'error');\n    }   \n  }\n  \n  onStartYouTubeDL = (videoId, taskId) => {\n    this.props.snackbarMessage('Youtube video \"' + videoId + '\" download started...');\n    const list = this.state.youtubeDL;\n    list[videoId] = { taskId, done: false};\n    this.setState({youtubeDL: list});\n\n    (function fetchStatus (t) {\n      $.ajax({\n        url: t.state.params.apiRoot + '/tasks/' + taskId,\n        type: 'GET',\n        headers: {\n          Authorization: 'Token ' + t.state.params.authToken\n        }\n      }).done(response => {\n        if(!response.pk) {\n          if (response.error) {\n            t.props.snackbarMessage('Youtube video \"' + videoId + '\" download failed', {variant: 'error'});\n          } else {\n            setTimeout(((tt) => (() => fetchStatus(tt)))(t), 1000);\n          }\n        } else {\n          t.props.snackbarMessage('Youtube video \"' + videoId + '\" download complete', {variant: 'success'});\n        }\n      });\n    })(this);\n  }\n\n  onYoutubeFail = (e, videoId) => {\n    if (e.status === 401) {\n      this.clearAuthToken();\n    } else {\n      swal('Oops!', 'Youtube download ' + videoId + ' did not go through...', 'error');\n    }\n  }\n  onAjaxFail = (e) => {\n    if (e.status === 401) {\n      this.clearAuthToken();\n    }\n  }\n  onRandomAudioLoaded = audioInfo => {\n    console.log('GOTCHA!!! ', audioInfo)\n    this.setState({\n      fetchingNext: false,\n      currentAudio: audioInfo,\n    });\n\n    if ('mediaSession' in navigator) {\n      /*eslint-disable no-undef*/\n      const filename = audioInfo.filename\n      navigator.mediaSession.metadata = new MediaMetadata({\n        title: filename.split('/').pop(),\n        artwork: [\n          { src: audioInfo.download_url + '.jpg?auth_token=' + this.state.params.authToken, sizes: '500x500', type: 'image/jpg' },\n        ]\n      });\n      /*eslint-enable no-undef*/\n\n      navigator.mediaSession.setActionHandler('play', ()=>{\n        this.setState({ pause: false, playing: true });\n        this.audio.play();\n        this.props.onTogglePause(false);\n      });\n      navigator.mediaSession.setActionHandler('pause', ()=>{\n        this.setState({ pause: true, playing: true });\n        this.audio.pause();\n        this.props.onTogglePause(true);\n      });\n      navigator.mediaSession.setActionHandler('nexttrack', this.playNext);\n    }\n  }\n  playNext = () => {\n    console.log('NEXT!!!')\n    this.setState({\n      playId: '',\n      currentAudio: {}\n    });\n    if (this.state.queue.length > 0) {\n      const newQueue = this.state.queue.filter(() => true);\n      const nextAudio = newQueue.shift();\n      this.setState({queue: newQueue});\n      this.onRandomAudioLoaded(nextAudio);\n      return\n    }\n    if (!this.state.fetchingNext) {\n      this.fetchRandomAudio(true)\n      console.log('FETCH!!!')\n    }\n  }\n  getAudioTitle = () => {\n    const { filename } = this.state.currentAudio;\n    return filename ? filename.split('/').pop() : '-'\n  }\n  getAudioSrc = () => {\n    const { currentAudio, params: { authToken } } = this.state;\n    return currentAudio.download_url ? currentAudio.download_url + '.mp3?auth_token=' + authToken : null;\n  }\n  onSearchPrompt = () => {\n  }\n  togglePause = () => {\n\n  }\n  setAudioLength = () => {\n    this.setState({\n      duration: this.audio.duration\n    });\n  };\n  canPlay = () => {\n    this.setAudioLength();\n    this.loadAndPlayAudio();\n    this.setState({\n      loading: false,\n      playing: false\n    });\n  };\n  loadAndPlayAudio = () => {\n    const { loadProgress, firstPlay } = this.state;\n    const { networkState } = this.audio;\n    const maxLoadProgress = 100;\n    this.setState({ loading: true });\n    if (loadProgress < maxLoadProgress) {\n      this.setState({ loadProgress: loadProgress + 1 });\n    }\n    if (\n      networkState !== this.NETWORK_STATE.NETWORK_NO_SOURCE\n    ) {\n      \n      this.setState(\n        {\n          playing: !firstPlay,\n          loading: false,\n          pause: firstPlay,\n          loadProgress: maxLoadProgress\n        },\n        () => {\n          if (firstPlay) {\n            //this.audio.play();\n          }\n          this.setState({ firstPlay: false });\n          this.props.onTogglePause(firstPlay);\n        }\n      );\n    } else {\n      this.onAudioLoadError();\n    }\n  };\n  audioEnd = () => {\n    this.playNext();\n  };\n  onAudioLoadError = e => {\n    if (this.audio.error) {\n      console.log('Audio error ', this.audio.error);\n      this.playNext();\n    }\n  };\n  onAudioSeeked = () => {\n    if (this.state.playing) {\n      this.loadAndPlayAudio();\n      setTimeout(() => {\n         this.setState({ playing: true });\n      });\n    }\n  };\n  onPauseAudio = () => {\n  };\n  onAudioPlay = () => {\n    this.setState({ playing: true, loading: false });\n  };\n  bindEvents = (\n    target = this.audio,\n    eventsNames = {\n      waiting: this.loadAndPlayAudio,\n      canplay: this.canPlay,\n      error: this.onAudioLoadError,\n      ended: this.audioEnd,\n      seeked: this.onAudioSeeked,\n      pause: this.onPauseAudio,\n      play: this.onAudioPlay,\n      timeupdate: this.audioTimeUpdate,\n      stalled: this.onAudioLoadError,\n      abort: this.onAudioAbort\n    },\n    bind = true\n  ) => {\n    const { once } = this.props;\n    let name;\n    for (name in eventsNames) {\n      const _events = eventsNames[name];\n      bind\n        ? target.addEventListener(name, _events, {\n            once: !!(once && name === \"play\")\n          })\n        : target.removeEventListener(name, _events);\n    }\n  };\n  onAudioAbort = e => {\n      this.audio.pause()\n      this.audio.play();\n  };\n  _pauseAudio = () => {\n    this.audio.pause();\n    this.setState({ playing: false, pause: true });\n  };\n  onTogglePlay = () => {\n    const { playId } = this.state;\n    this.onCurrentAudioPlay(playId);\n  }\n  audioTimeUpdate = () => {\n    const currentTime = this.audio ? this.audio.currentTime : 0;\n    this.setState({ currentTime });\n    if (this.props.remember) {\n      this.saveLastPlayStatus();\n    }\n    this.props.onAudioProgress &&\n      this.props.onAudioProgress(this.getBaseAudioInfo());\n  };\n  getProgressText = () => {\n    const { currentTime } = this.state;\n    const duration = this.audio ? this.audio.duration : 0;\n    return printTime(currentTime) + '/' + printTime(duration);\n  };\n  getProgressPercentage = () => {\n    const { currentTime } = this.state;\n    const duration = this.audio ? this.audio.duration : 0;\n    return duration ? currentTime / duration * 100 : 0;\n  }\n  onCurrentAudioPlay = (playId, ignore = false) => {\n    const { playId: currentPlayId, pause, playing, currentAudio } = this.state;\n\n    if (!currentAudio.id) {\n      /*eslint-disable no-console*/\n      console.log('no audio')\n      /*eslint-disable no-console*/\n    }\n    if (playId === currentPlayId && !ignore) {\n      this.setState({ pause: !pause, playing: !playing });\n      if (pause) {\n        this.audio.play();\n      } else {\n        this.audio.pause();\n      }\n      this.props.onTogglePause(!pause)\n      return \n    }\n\n    const playingAudio = playId === currentAudio.id ? currentAudio : {}\n    const loadAudio = musicSrc => {\n      this.setState(\n        {\n          currentTime: 0,\n          duration: 0,\n          playing: false,\n          loading: true,\n          loadProgress: 0,\n          currentAudio: playingAudio,\n          playId,\n        },\n        () => {\n          this.audio.load();\n        }\n      );\n    };\n\n    loadAudio(this.getAudioSrc());\n  };\n  searchInputKeyPress = (e) => {\n    if (e.which === 13) {\n      const query = e.target.value;\n      console.log('Searching', query);\n      if (this.state.searchTimeout) {\n        clearTimeout(this.state.searchTimeout);\n      }\n      const searchTimeout = setTimeout(\n        () => this.searchSongs(query),\n        0,\n      );\n      this.setState({searchTimeout});\n      e.target.blur()\n    }\n  }\n  onSubmitSearchForm = (e) => {\n    e.preventDefault();\n    $(e.target).find('.searchInput').trigger('keypress');\n  }\n  searchSongs = function(query) {\n    this.setState({viewQueue: false});\n    if (this.state.xhrSearch) {\n      this.state.xhrSearch.abort();\n    }\n    const xhrSearch = $.ajax({\n      url: this.state.params.apiRoot + '/songs/',\n      data: {'q': query},\n      method: 'GET',\n      dataType: 'json',\n      headers: {\n          Authorization: 'Token ' + this.state.params.authToken\n      }\n    }).done(songs => {\n        this.setState({xhrSearch: null});\n        console.log('Found ' + songs.length + ' match for query \"' + query + '\"');\n        this.setState({searchResults: songs});\n    }).fail(e => {\n        if (e.status === 401) {\n            this.clearAuthToken();\n        }\n        this.setState({searchResults: []});\n    });\n    this.setState({xhrSearch: xhrSearch});\n  };\n  deleteAudio = async (song) => {\n    const { apiRoot, authToken } = this.state.params;\n    const hasConfirmed = await swal('Are you sure you want to delete this file \"'+song.filename.split('/').pop()+'\"?');\n    if (hasConfirmed) {\n      $.ajax({\n        url: apiRoot + '/songs/' + song.id,\n        method: 'DELETE',\n        dataType: 'JSON',\n        headers: {\n          Authorization: 'Token ' + authToken\n        }\n      }).done(() => {\n        console.log('Song ' + song.id + ' Deleted');\n        const searchResults = this.state.searchResults.filter(s => s.id !== song.id);\n        this.setState({searchResults});\n        //queue = queue.filter(function(s) {return s.id !== song.id});\n        if (this.state.currentAudio.id === song.id) {\n          this.playNext();\n        }\n      }).fail(function (e) {\n        if (e.status === 401) {\n          this.clearAuthToken();\n        }\n      });\n    }\n  };\n  editAudioFilename = async function(song) {\n    var newPath = await swal('new file path', {\n      content: {\n        element: 'input',\n        attributes: {\n          defaultValue: song.filename,\n        }\n      }\n    });\n    if (newPath && newPath !== song.filename) {\n        const { apiRoot, authToken } = this.state.params;\n        $.ajax({\n            url: apiRoot + '/songs/'+song.id,\n            method: 'PATCH',\n            data: {filename: newPath},\n            dataType: 'JSON',\n            headers: {\n              Authorization: 'Token ' + authToken\n            }\n        }).done(() => {\n          console.log('Filename changed from '+ song.filename + ' to ' + newPath);\n          const searchResults = this.state.searchResults.map(s => {\n            if(s.id !== song.id) {\n              return s\n            }\n            s.filename = newPath;\n            return s;\n          });\n          this.setState({searchResults});\n        }).fail(e => {\n          if (e.status === 401) {\n            this.clearAuthToken()\n          } else {\n            swal('Something went wrong...', '', 'error');\n          }\n        });\n    }\n  };\n  onAudioDownload = audio => {\n    const { authToken } = this.state.params;\n    const name = audio.filename ? audio.filename.split('/').pop() + '.mp3' : '';\n    const url = audio.download_url + '.mp3?auth_token=' + authToken\n    if (name && url) {\n      this.downloadNode.setAttribute(\"download\", name);\n      this.downloadNode.setAttribute(\"name\", name);\n      this.downloadNode.setAttribute(\"href\", url);\n      this.downloadNode.click();\n    }\n  };\n  onMP3Upload = () => {\n    const newWindow = window.open('/mp3-upload.html', 'upload', 'height=480,width=640');\n    if (window.focus) {\n       newWindow.focus()\n    }\n    return false;\n  };\n  onClickProgressBar = e => {\n    var perc = e.pageX/$(this.progressBar).width();\n    if (this.audio) {\n      var target = this.audio.duration * perc\n      console.log('Seek song ' + printTime(target));\n      this.audio.currentTime = target;\n    }\n  };\n  displayQueue = e => {\n    this.setState({viewQueue: true});\n  }\n  render() {\n    const { \n      params: { authToken, username, isSuperuser},\n      currentAudio,\n      attemptingLogin,\n      pause,\n      searchResults,\n      xhrSearch,\n      queue,\n      viewQueue,\n    } = this.state;\n\n    return (\n      <div>\n        { authToken &&\n         <div\n          className=\"progressbar\"\n          onClick={this.onClickProgressBar}\n          ref={node => (this.progressBar = node)}\n          title={this.getProgressText()}\n          >\n          <div\n           className=\"progressbarBar\"\n           style={{width: (this.getProgressPercentage() + '%')}}\n          ></div>\n        </div>}\n        { authToken && !currentAudio &&\n          <div id=\"loading\">\n            <i className=\"fas fa-spinner fa-spin\"></i> Loading\n          </div>\n        }\n        { !authToken && <div className=\"loginComponent\">\n          <form className=\"loginForm\" onSubmit={this.onLogin}>\n            <div className=\"usernameInputWrapper\">\n              <input  \n                ref={node => (this.usernameInput = node)}\n                type=\"text\"\n                className=\"usernameInput\"\n               placeholder=\"Username\" />\n            </div>\n            <div className=\"passwordInputWrapper\">\n              <input \n                ref={node => (this.passwordInput = node)}\n                type=\"password\"\n                className=\"passwordInput\"\n                placeholder=\"Password\"/>\n            </div>\n            <div>\n              <button type=\"submit\" className=\"loginBtn myBtn\">\n                <i className={!attemptingLogin ? \"fas fa-sign-in-alt fa-fw\" : 'fas fa-spinner fa-spin'}></i> Login\n              </button>\n            </div>\n          </form>\n          <p><small>This app offers its users the pleasure to listen to their favourite songs in a good old stereo fashion.<br/>No surround sound bullshit here, Good old MPEG-1 standard only.</small></p>\n          <p><small>Contact: <a href={'mailto:' + pkg.contact_email}>{pkg.contact_email}</a></small></p>\n        </div>}\n        { authToken && <div className=\"jukebox\">\n          <div className=\"iconMenu\">\n            <span>\n              <img\n                className={\"mainCover\" + (pause ? \"\" : \" rotate\")} \n                src={currentAudio.download_url ? currentAudio.download_url + '.jpg?auth_token=' + authToken : '/vinyl.jpg'}\n                alt=\"\"\n              />\n            </span>\n            <span\n              className=\"playPauseButton link\"\n              onClick={this.onTogglePlay}\n              title=\"Play/Pause\">\n              <i className={pause ? \"fas fa-fw fa-play\" : \"fas fa-fw fa-pause\"}></i>\n            </span>\n            <span\n              onClick={this.playNext} \n              title=\"Next\"\n              className=\"link\">\n              <i className=\"fas fa-fw fa-forward\"></i>\n            </span>\n            <span\n              onClick={this.onYoutubeDlPrompt} \n              title=\"Import From Youtube\"\n              className=\"link youtube\">\n              <i className=\"fab fa-fw fa-youtube\"></i>\n            </span>\n            <span\n              onClick={() => this.onAudioDownload(currentAudio)} \n              title=\"Download\"\n              className=\"link\">\n              <a\n                href={this.getAudioSrc()}\n                ref={node => (this.downloadNode = node)}\n              >\n                <i className=\"fas fa-fw fa-cloud-download-alt\"></i>\n              </a>\n            </span>\n            <span\n              onClick={() => this.onMP3Upload(currentAudio)} \n              title=\"MP3 Upload\"\n              className=\"link\">\n             <i className=\"fas fa-fw fa-upload\"></i>\n            </span>\n            <span\n              onClick={this.onLogout}\n              title=\"Sign out\"\n              className=\"logoutBtn link\">\n                <i className=\"fas fa-fw fa-sign-out-alt\"></i>\n            </span>\n          </div>\n          <div className=\"currentTitle\">Now Playing: <span id=\"currentTitle\" title={currentAudio.filename}>{this.getAudioTitle() || '-'}</span></div>\n          \n          <span className=\"searchInputWrapper\">\n            <form className=\"searchForm\" onSubmit={this.onSubmitSearchForm}>\n              <input type=\"search\" onKeyPress={this.searchInputKeyPress} className=\"searchInput\" placeholder=\"Search\"/>\n              <span onClick={this.displayQueue} className=\"link\"><i className=\"fas fa-layer-group\"></i></span></form>\n          </span>\n          { viewQueue ? \n          (\n            <div className=\"queueList\">\n              { queue.map((audio, idx) => (<QueueItem\n                  key={audio.id}\n                  audio={audio}\n                  username={username}\n                  isSuperuser={isSuperuser}\n                  queueIndex={idx}\n                  onQueueAudio={this.onQueueAudio}\n                  onRandomAudioLoaded={this.onRandomAudioLoaded.bind(this)}\n                  deleteAudio={this.deleteAudio.bind(this)}\n                  editAudioFilename={this.editAudioFilename.bind(this)} />)) }\n            </div>\n          )\n          : (<div className=\"searchResults\">\n            { xhrSearch &&\n              <i className=\"fas fa-spin fa-2x fa-compact-disc\"></i>\n            }\n            { !xhrSearch &&\n              searchResults.map(audio => (\n                <SearchResultItem\n                  key={audio.id}\n                  audio={audio}\n                  username={username}\n                  isSuperuser={isSuperuser}\n                  queue={queue}\n                  onQueueAudio={this.onQueueAudio}\n                  onRandomAudioLoaded={this.onRandomAudioLoaded.bind(this)}\n                  deleteAudio={this.deleteAudio.bind(this)}\n                  editAudioFilename={this.editAudioFilename.bind(this)} />)\n              )\n            }\n          </div>)\n          }\n        </div>\n        }\n        <div className=\"version\">\n          <small>{' v' + pkg.version}</small>\n        </div>\n        <audio\n          key=\"audio\"\n          className=\"music-player-audio\"\n          preload=\"auto\"\n          src={this.getAudioSrc()}\n          ref={node => (this.audio = node)}\n        />\n      </div>\n    );\n  }\n}\n\n\nfunction MyApp() {\n  const [playing, setPlaying] = React.useState(false);\n  useNoSleep(playing);\n  const {enqueueSnackbar} = useSnackbar();\n\n  return (\n    <App snackbarMessage={(msg, opts = {}) => enqueueSnackbar(msg, opts) } onTogglePause={(paused) => {console.log('noSleep ' + (!paused ? 'on' : 'off'));setPlaying(!paused)}}/>\n  );\n};\n\n\nexport default MyApp;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport * as Sentry from '@sentry/react';\nimport { Integrations } from \"@sentry/tracing\";\nimport { SnackbarProvider } from 'notistack';\n\nSentry.init({ \n  dsn: 'https://b31de5237b044454b3b61080061d6abd@o91052.ingest.sentry.io/273693',\n  integrations: [\n    new Integrations.BrowserTracing(),\n  ],\n  tracesSampleRate: 0.1,\n});\n\nReactDOM.render(<SnackbarProvider maxSnack={5}><App /></SnackbarProvider>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}